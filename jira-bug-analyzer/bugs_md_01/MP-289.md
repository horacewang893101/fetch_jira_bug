# MP-289: Insufficient Controls for Concurrent Sessions (Multi-Device Logins)

**Status:** Backlog

**Assignee:** Unassigned

**Description:**
*Initial assumptions:*

* Logged in as user: {{krzysztof.dolecki}} on: {{https://trial.aicentral.top/?mode=default}}
* Application allows the same user account to be logged in from multiple browsers/devices at the same time.
* Application uses JWT tokens stored in {{localStorage}} ({{$sm-access-token}}, {{$sm-refresh-token}}) to maintain authenticated sessions.
* No visible “session management” UI (list of active sessions, remote logout, etc.) is available to end users.

Recommendations (best practices when concurrent sessions are allowed):

* *Clearly define and document concurrent session policy:*
** Specify when and why multiple sessions per user are allowed (e.g., multi‑device usage such as laptop + mobile).
** Define hard limits, such as:
*** maximum number of active sessions per user,
*** optional limits per IP, device type, or geography.
* *Provide a dedicated Session Management page for users:*
** Show a list of all active sessions for the account, including:
*** browser / device type (e.g., “Chrome on Windows”, “Safari on iOS”),
*** IP address and/or approximate location,
*** login time and last activity time.
** Highlight unusual or risky sessions (e.g., new country, new device).
* *Allow remote termination of sessions:*
** Provide a *“Log out from all devices”* action (global logout).
** Allow terminating individual sessions from the Session Management page (e.g., “Log out this device”).
** Ensure that terminating a session:
*** immediately invalidates its access and refresh tokens server‑side,
*** prevents any further API/Chatbot calls with those tokens.
* *Enforce strong logout semantics:*
** Standard logout in any browser must:
*** invalidate that browser’s tokens on the server,
*** remove/neutralize local tokens ({{$sm-access-token}}, {{$sm-refresh-token}}) on the client.
** After logout, no API endpoint (including chatbot endpoints) should accept the old tokens.
* *Implement device/location awareness and user notifications:*
** Detect new logins from new devices or unusual locations.
** Optionally notify the user (e.g. email or in‑app notification: “New login from Chrome on Windows in <city>”).
** Provide a convenient link/button from the notification to:
*** open the Session Management page,
*** trigger “log out from all devices” when the login is not recognized.
* *Log and monitor session‑related security events:*
** Log creation and termination of sessions, especially:
*** many concurrent sessions,
*** logins from new or high‑risk locations.
** Feed these logs into security monitoring to detect:
*** possible account takeover,
*** anomalous concurrent access patterns.
