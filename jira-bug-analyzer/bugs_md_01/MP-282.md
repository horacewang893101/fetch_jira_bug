# MP-282: Insufficient validation of uploaded file name allows path traversal patterns in filename parameter

**Status:** Backlog

**Assignee:** Unassigned

**Description:**
*Initial assumptions:*

* Logged as user: krzysztof.dolecki on: [https://trial.aicentral.top/?mode=default|https://trial.aicentral.top/?mode=default]
* Base valid URL (existing object):
[https://trial.aicentral.top/knowledge/my-workspace/4518834372610363393|https://trial.aicentral.top/knowledge/my-workspace/4518834372610363393]

*Steps:*

# Authenticate and navigate to a feature that triggers the personal file upload.
# Intercept the upload request (e.g., using browser DevTools “Edit and Resend” or a proxy like Fiddler/Burp).
# Modify the multipart form-data header for the uploaded file so that the {{filename}} includes a traversal pattern, for example:
{noformat}Content-Disposition: form-data; name="Files"; filename="..\..\..\windows\win.ini"{noformat}
# Keep the rest of the request unchanged (valid workspaceId, valid file content).
# Send the modified request to:

{noformat}POST /knowledge-webapi/api/admincenter/persionalfile/upload?workspaceId=4518834372610363393{noformat}
# Observe the JSON response.

*Current result:* The server responds with HTTP {{200 OK}}.

* The response body includes the unsanitized, traversal-style file name in {{fullName}}:

{noformat}{
  "data": [
    {
      "fullName": "/..\\..\\..\\windows\\win.ini",
      "id": "4529123214357430272"
    }
  ],
  "success": true,
  "msg": ""
}{noformat}

* No validation error or rejection of the dangerous {{filename}} is returned.
* From the UI you can find a file with an incorrect name.

!2026-01-06_171332.png|width=645,alt="2026-01-06_171332.png"!

*Expected results:* 

* The application should *validate and sanitize* the {{filename}} parameter in multipart uploads and:
** Reject names containing directory traversal sequences such as {{..}}, {{/}}, {{\}}, or absolute paths ({{C:\}}, {{/etc/}}), or
** Normalize and constrain the name to a safe subset (e.g., base file name only, no path components).
* The response should not expose untrusted path fragments such as {{..\..\..\windows\win.ini}} in any field.
* Under no circumstances should user-controlled {{filename}} be used directly to construct filesystem paths outside a controlled upload directory.

*Impact / Risk:*

* The current behavior shows that user-controlled file names with traversal patterns are:
** Accepted by the server.
** Persisted and returned back in the API response.
* If {{fullName}} or the original {{filename}} is later:
** concatenated into a filesystem path, or
** resolved by the server when serving downloads / previews,
* this may lead to:
** *Path Traversal / Directory Traversal*:
*** Possible read/write outside the intended upload directory.
*** Potential access to sensitive files (e.g. configuration, logs, system files like {{win.ini}}).
** *Information disclosure* (if errors reveal real filesystem paths or contents).
** In the worst case, combined with other weaknesses, it might be used to assist in further exploitation.
