# MP-273: Multiple Sensitive Keys Exposed in Azure Key Vault Secret celery-env

**Status:** Backlog

**Assignee:** Unassigned

**Description:**
*Description*
The Key Vault secret {{celery-env}} contains multiple highly sensitive values bundled together, including database credentials, Redis credentials, and application secrets. This monolithic secret increases blast radius and complicates rotation and RBAC.

*Whatâ€™s Exposed (from* {{celery-env}}*)*

* *Database:*
** {{LANGFLOW_DATABASE_URL=postgresql://postgres:postgres@serviceme-pg9gudls.postgres.database.azure.com:5432/serviceme-db}}
* *Redis:*
** {{LANGFLOW_REDIS_URL=rediss://:********@serviceme-redis-maximum-stud.redis.cache.windows.net:6380/0}}
* *Admin:*
** {{LANGFLOW_SUPERUSER_PASSWORD='********'}}
* *Encryption/App Secrets:*
** {{LANGFLOW_LICENSE_SECRET_KEY=********}}
** {{LANGFLOW_HASH_PART_1=********}}
** {{LANGFLOW_HASH_PART_2=********}}
* *Other:*
** Internal service URL ({{LANGFLOW_IAM_SERVICE}}) and operational flags mixed with secrets.

*Impact*
If {{celery-env}} is compromised, attacker gains full control over DB, Redis, LangFlow admin, and crypto materials, enabling data exfiltration, cache/session hijacking, and token/secret forgery.

*Severity*: Critical

*Recommended Fix*

* Split into *individual Key Vault secrets* (DB creds, Redis password, admin password, app/crypto keys), rotate all exposed values, enforce Key Vault RBAC per secret, and avoid bundling non-sensitive config with secrets.
* Use *Key Vault references* or *CSI Secrets Store* to mount secrets as files with strict permissions; fetch secrets at runtime via *Managed Identity* and avoid logging env values.
