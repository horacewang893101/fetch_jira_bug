# MP-270: Multiple Sensitive Keys Exposed in Azure Key Vault Secret backend-env

**Status:** Backlog

**Assignee:** Unassigned

**Description:**
*Description*
The Azure Key Vault secret {{backend-env}} bundles numerous highly sensitive values in one place, including database credentials, Redis credentials, LangFlow admin credentials, and encryption keys. This monolithic secret increases blast radius and complicates rotation and RBAC.

*Whatâ€™s Exposed (from* {{backend-env}}*)*

* *Database:*
** {{LANGFLOW_DATABASE_URL}} (PostgreSQL superuser {{postgres}} with password)
** {{DB_USER=postgres}}, {{DB_PASSWORD=postgres}}
* *Redis:*
** {{LANGFLOW_REDIS_URL=rediss://:********@serviceme-redis-maximum-stud.redis.cache.windows.net:6380/0}}
** {{REDIS_PASSWORD=********}}
* *Admin:*
** {{LANGFLOW_SUPERUSER=admin}}
** {{LANGFLOW_SUPERUSER_PASSWORD='********'}}
* *Encryption/App Secrets:*
** {{LANGFLOW_LICENSE_SECRET_KEY=********}}
** {{LANGFLOW_SECRET_KEY=********}}
** {{LANGFLOW_ECB_KEY=********}}
* *Other:*
** Internal endpoints (e.g., {{LANGFLOW_IAM_SERVICE}}) and flags mixed with secrets

*Impact*
If {{backend-env}} is compromised, attacker gains full control over DB, Redis, LangFlow admin, and crypto materials, enabling data exfiltration, cache/session hijacking, and token/secret forgery.

*Severity*: Critical

*Recommended Fix*

* Split into *individual* Key Vault secrets (DB creds, Redis password, admin password, app/crypto keys), rotate all exposed values, enforce Key Vault RBAC per secret, and avoid bundling non-sensitive config with secrets.
* Use *Key Vault references* or *CSI Secrets Store* to mount secrets as files with strict permissions; fetch secrets at runtime via *Managed Identity* and avoid logging env values.
